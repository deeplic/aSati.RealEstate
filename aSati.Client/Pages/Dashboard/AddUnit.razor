@page "/property/{PropertyId:guid}/units/add"
@using aSati.Shared.Models
@inject HttpClient Http
@inject NavigationManager Nav

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h6">Add Unit</MudText>

    <MudTextField Label="Unit Name" @bind-Value="unit.Name" Required="true" />

    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="Save">Save</MudButton>
</MudPaper>

@code {
    [Parameter] public Guid PropertyId { get; set; }
    private PropertyUnit unit = new();

    protected override void OnInitialized()
    {
        unit.PropertyId = PropertyId;
    }

    private async Task Save()
    {
        var response = await Http.PostAsJsonAsync("api/unit", unit);
        if (response.IsSuccessStatusCode)
        {
            Nav.NavigateTo($"/property/{PropertyId}/units");
        }
    }
}